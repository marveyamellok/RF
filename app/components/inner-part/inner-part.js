$(function () {
  var data;

  $(window).on( "main:ready", function( e, _data ) {
    data = _data;
    showContent();
  });

  $(window).on("main:page_changed", function( e, _data){

    data = _data;
    hideContent( showContent );

  });

  function hideContent(m){

    $('.inner-part').fadeOut( "fast", function() {
      if( m ) m();
    });

  }

  function showContent(){

    var pageNow = data.header.current_page;
    var lang = data.header.current_language;
    var context = data.content[pageNow];
    var theTemplateScript = $("#entry-template").html();
    var theTemplate = Handlebars.compile(theTemplateScript);
    var theCompiledHtml = theTemplate( { image: context.image, title: context.title[lang], text:context.text[lang] } );

    $('.inner-part')
      .html(theCompiledHtml)
      .fadeIn( "slow" )
    ;

  }

});
